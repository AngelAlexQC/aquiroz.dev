---
import { experienceDates, formatPeriod } from "../utils/dates";

export interface Props {
  lang: 'es' | 'en';
}

const { lang } = Astro.props;

const experiences = [
  {
    title: lang === 'es' ? 'Líder Técnico' : 'Technical Lead',
    company: 'Libélula Soft',
    period: formatPeriod(experienceDates.libelulaStart, null, lang),
    description: lang === 'es' 
      ? 'Lidero proyectos de sistemas empresariales en PHP (Yii2), diseño de APIs y automatización DevOps. Superviso calidad de código y mentorización de equipos de 5+ desarrolladores. Colaboro con stakeholders para entregas a tiempo y dentro de presupuesto.'
      : 'Lead enterprise systems projects in PHP (Yii2), API design and DevOps automation. Supervise code quality and mentor teams of 5+ developers. Collaborate with stakeholders for timely and budget-compliant deliveries.'
  },
  {
    title: lang === 'es' ? 'Ingeniero Fullstack & Backend' : 'Fullstack & Backend Engineer',
    company: 'Freelance',
    period: formatPeriod(experienceDates.freelanceStart, null, lang),
    description: lang === 'es' 
      ? 'Diseño e implemento soluciones personalizadas con NestJS, monorepos y empaquetado NPM. Automatizo infraestructuras CI/CD y pipelines de despliegue. Entrego proyectos de alto impacto para clientes de EE. UU., México y Ecuador.'
      : 'Design and implement custom solutions with NestJS, monorepos and NPM packaging. Automate CI/CD infrastructures and deployment pipelines. Deliver high-impact projects for clients from the US, Mexico and Ecuador.'
  },
  {
    title: lang === 'es' ? 'Líder Técnico / Desarrollador Full Stack' : 'Technical Lead / Full Stack Developer',
    company: 'Edgebound',
    period: formatPeriod(experienceDates.edgeboundStart, experienceDates.edgeboundEnd, lang),
    description: lang === 'es' 
      ? 'Migré plataformas a Next.js, mejorando rendimiento y mantenibilidad. Desarrollé microservicios con RabbitMQ e integré HCL Commerce. Implementé pipelines CI/CD y estándares de calidad de código.'
      : 'Migrated platforms to Next.js, improving performance and maintainability. Developed microservices with RabbitMQ and integrated HCL Commerce. Implemented CI/CD pipelines and code quality standards.'
  },
  {
    title: lang === 'es' ? 'Desarrollador Full Stack' : 'Full Stack Developer',
    company: 'APS',
    period: formatPeriod(experienceDates.apsStart, experienceDates.apsEnd, lang),
    description: lang === 'es' 
      ? 'Desarrollé funcionalidades en VueJS, NextJS y Ruby on Rails. Lideré un proyecto frontend con Next.js y arquitectura escalable. Mejoré flujos de desarrollo con GitHub Actions y ESLint.'
      : 'Developed features in VueJS, NextJS and Ruby on Rails. Led a frontend project with Next.js and scalable architecture. Improved development workflows with GitHub Actions and ESLint.'
  },
  {
    title: lang === 'es' ? 'Desarrollador Full Stack' : 'Full Stack Developer',
    company: 'GAD Portoviejo',
    period: formatPeriod(experienceDates.portoviejoGadStart, experienceDates.portoviejoGadEnd, lang),
    description: lang === 'es' 
      ? 'Implementé sistema de recolección de residuos en tiempo real con Laravel + Node.js. Frontend en Angular + Ionic, integraciones Google Maps API y Firebase. Notifiqué usuarios vía Twilio y Firebase Cloud Messaging.'
      : 'Implemented real-time waste collection system with Laravel + Node.js. Frontend in Angular + Ionic, Google Maps API and Firebase integrations. User notifications via Twilio and Firebase Cloud Messaging.'
  },
  {
    title: lang === 'es' ? 'Desarrollador Full Stack' : 'Full Stack Developer',
    company: lang === 'es' ? 'Inst. Superior Tecnológico Portoviejo' : 'Portoviejo Technical Institute',
    period: formatPeriod(experienceDates.portoviejoInstStart, experienceDates.portoviejoInstEnd, lang),
    description: lang === 'es' 
      ? 'Desarrollé sistema académico integral: matrículas, pagos, facturación electrónica (Datil API). Frontend en Angular, backend en Laravel. Optimicé procesos administrativos y de asistencia.'
      : 'Developed comprehensive academic system: enrollment, payments, electronic invoicing (Datil API). Frontend in Angular, backend in Laravel. Optimized administrative and attendance processes.'
  }
];
---

<section id="experience" class="py-24 bg-gradient-to-br from-gray-50 to-blue-50">
  <div class="max-w-4xl mx-auto px-4">
    <div class="text-center mb-16">
      <span class="text-blue-600 font-semibold text-sm uppercase tracking-wider">
        {lang === 'es' ? 'Mi trayectoria' : 'My journey'}
      </span>
      <h2 class="text-5xl font-bold mt-4 mb-6">
        <span class="text-gray-900">{lang === 'es' ? 'Experiencia' : 'Experience'}</span>
        <span class="gradient-text"> {lang === 'es' ? 'Profesional' : 'Professional'}</span>
      </h2>
    </div>
    
    <div class="relative">
      <!-- Timeline line -->
      <div class="absolute left-6 top-0 bottom-0 w-0.5 bg-gradient-to-b from-blue-600 via-purple-600 to-pink-600"></div>
      
      <div class="space-y-8">
        {experiences.map((exp, index) => (
          <div class="relative flex items-start">
            <!-- Timeline dot -->
            <div class="relative z-10 flex items-center justify-center w-12 h-12 bg-white border-4 border-blue-600 rounded-full shadow-lg">
              <div class="w-3 h-3 bg-blue-600 rounded-full"></div>
            </div>
            
            <!-- Content card -->
            <div class="ml-8 flex-1">
              <div class="bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
                <!-- Header -->
                <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-4">
                  <div>
                    <h3 class="text-lg font-bold text-gray-900 mb-1">{exp.title}</h3>
                    <p class="text-blue-600 font-medium">{exp.company}</p>
                  </div>
                  <div class="text-sm text-gray-500 font-medium mt-2 md:mt-0">
                    {exp.period}
                  </div>
                </div>
                
                <!-- Description -->
                <p class="text-gray-700 leading-relaxed">{exp.description}</p>
                
                <!-- Tech stack (optional) -->
                <div class="flex flex-wrap gap-2 mt-4">
                  {index === 0 && (
                    <>
                      <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium">PHP</span>
                      <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs font-medium">Yii2</span>
                      <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium">DevOps</span>
                    </>
                  )}
                  {index === 1 && (
                    <>
                      <span class="bg-indigo-100 text-indigo-800 px-2 py-1 rounded text-xs font-medium">NestJS</span>
                      <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium">Docker</span>
                      <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium">CI/CD</span>
                    </>
                  )}
                  {index === 2 && (
                    <>
                      <span class="bg-cyan-100 text-cyan-800 px-2 py-1 rounded text-xs font-medium">Next.js</span>
                      <span class="bg-orange-100 text-orange-800 px-2 py-1 rounded text-xs font-medium">RabbitMQ</span>
                      <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs font-medium">HCL Commerce</span>
                    </>
                  )}
                  {index === 3 && (
                    <>
                      <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium">Vue.js</span>
                      <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium">Next.js</span>
                      <span class="bg-red-100 text-red-800 px-2 py-1 rounded text-xs font-medium">Ruby on Rails</span>
                    </>
                  )}
                  {index === 4 && (
                    <>
                      <span class="bg-orange-100 text-orange-800 px-2 py-1 rounded text-xs font-medium">Laravel</span>
                      <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium">Node.js</span>
                      <span class="bg-red-100 text-red-800 px-2 py-1 rounded text-xs font-medium">Angular</span>
                    </>
                  )}
                  {index === 5 && (
                    <>
                      <span class="bg-red-100 text-red-800 px-2 py-1 rounded text-xs font-medium">Angular</span>
                      <span class="bg-orange-100 text-orange-800 px-2 py-1 rounded text-xs font-medium">Laravel</span>
                      <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium">API Datil</span>
                    </>
                  )}
                </div>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>
