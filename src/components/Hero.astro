---
import { t } from "../utils/translations";
import { calculateYearsOfExperience } from "../utils/dates";

export interface Props {
  lang: "es" | "en";
}

const { lang } = Astro.props;
const yearsOfExperience = calculateYearsOfExperience();
---

<!-- CSS crítico para el avatar en línea -->
<style is:inline>
  /* Estilos mínimos para el avatar y el LCP */
  #hero-avatar {
    background: linear-gradient(to right, #2563eb, #8b5cf6, #4338ca);
    border-radius: 9999px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    font-size: 2.25rem;
    font-weight: bold;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    width: 9rem;
    height: 9rem;
  }
  #hero-avatar span {
    transition: transform 0.3s;
  }
  #hero-avatar.animated span {
    /* Solo animar después del primer render */
  }
  #hero-avatar.animated:hover span {
    transform: scale(1.1);
  }
</style>

<section
  class="pt-16 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 min-h-screen flex items-center relative overflow-hidden"
  aria-label={t("hero.aria_label", lang)}>
  <!-- Background Elements mejorados -->
  <div
    class="absolute inset-0 bg-gradient-to-br from-blue-100/60 via-indigo-100/40 to-purple-100/60">
  </div>

  <!-- Elementos de fondo sutiles -->
  <div class="absolute inset-0 pointer-events-none">
    <!-- Orbs de color suaves -->
    <div
      class="absolute top-20 left-10 w-32 h-32 bg-gradient-to-r from-blue-300/40 to-cyan-300/35 rounded-full blur-xl animate-float-slow">
    </div>
    <div
      class="absolute top-40 right-20 w-48 h-48 bg-gradient-to-r from-purple-300/30 to-pink-300/25 rounded-full blur-2xl animate-float-slower">
    </div>
    <div
      class="absolute bottom-40 left-20 w-40 h-40 bg-gradient-to-r from-indigo-300/35 to-blue-300/30 rounded-full blur-xl animate-float-reverse">
    </div>

    <!-- Grid sutil de fondo -->
    <div class="absolute inset-0 bg-grid-pattern opacity-[0.04]"></div>
  </div>

  <div class="relative max-w-7xl mx-auto px-4 py-20">
    <div class="text-center">
      <!-- Enhanced Avatar with status indicator -->
      <div
        class="relative mx-auto w-36 h-36 mb-8 animate-fade-up"
        id="hero-avatar-container">
        <!-- Main avatar -->
        <div id="hero-avatar" class="w-full h-full group">
          <span>AQ</span>
        </div>

        <!-- Status indicator with pulse -->
        <div
          class="absolute -bottom-2 -right-2 w-8 h-8 bg-green-500 rounded-full border-4 border-white shadow-lg">
          <div
            class="absolute inset-0 bg-green-500 rounded-full animate-ping opacity-75">
          </div>
        </div>
      </div>

      <!-- Enhanced Title with better typography -->
      <h1
        id="hero-title"
        class="text-6xl md:text-8xl font-bold mb-6 animate-fade-up leading-tight"
        style="animation-delay: 0.2s; font-size: 3.75rem;">
        <span
          class="gradient-text hover:scale-105 inline-block transition-transform duration-300 cursor-default"
          >Ángel</span
        >
        <span
          class="text-gray-900 hover:text-gray-700 transition-colors duration-300 cursor-default"
          >Quiroz</span
        >
      </h1>

      <!-- Simplified subtitle -->
      <div class="mb-8 animate-fade-up" style="animation-delay: 0.4s;">
        <p class="text-xl md:text-2xl text-gray-600 font-medium mb-3">
          <span class="font-mono text-blue-600 text-2xl">&gt;</span>
          <span class="ml-2">{t("hero.senior_software_engineer", lang)}</span>
          <span class="animate-pulse text-blue-600 ml-1">|</span>
        </p>
        <p class="text-lg text-gray-500">
          {t("hero.fullstack_specialist", lang)}
        </p>
      </div>

      <!-- Enhanced CTA Buttons with better styling -->
      <div
        class="flex flex-col sm:flex-row gap-6 justify-center items-center animate-fade-up mb-16"
        style="animation-delay: 0.6s;">
        <a
          href={"/cv-en.pdf"}
          download
          aria-label={t("hero.cv_aria_label", lang)}
          class="group relative bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-700 text-white px-10 py-5 rounded-full font-semibold shadow-xl hover:shadow-2xl transform hover:scale-105 transition-all duration-300 flex items-center space-x-3 overflow-hidden">
          <!-- Hover effect overlay -->
          <div
            class="absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 transform -skew-x-12 -translate-x-full group-hover:translate-x-full transition-transform duration-700">
          </div>
          <svg
            class="w-6 h-6 group-hover:rotate-12 transition-transform relative z-10"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
            ></path>
          </svg>
          <span class="relative z-10">{t("hero.download_cv", lang)}</span>
        </a>

        <a
          href="#contact"
          aria-label={t("hero.contact_aria_label", lang)}
          class="group relative glass-effect text-gray-700 px-10 py-5 rounded-full font-semibold hover:bg-white/50 transition-all duration-300 flex items-center space-x-3 border border-white/30 hover:border-white/60">
          <svg
            class="w-6 h-6 group-hover:rotate-12 transition-transform"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
            ></path>
          </svg>
          <span>{t("hero.contact_me", lang)}</span>
        </a>
      </div>

      <!-- Simple experience indicator -->
      <div
        class="flex justify-center items-center text-sm text-gray-500 animate-fade-up"
        style="animation-delay: 0.8s;">
        <div class="text-center">
          <span class="font-semibold text-blue-600">{yearsOfExperience}+</span>
          <span class="ml-1">{t("hero.years_experience", lang)}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Enhanced Scroll indicator -->
  <div
    class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce cursor-pointer group"
    onclick="document.getElementById('about').scrollIntoView({behavior: 'smooth'})">
    <div
      class="bg-white/20 backdrop-blur-sm rounded-full p-3 group-hover:bg-white/30 transition-all duration-300">
      <svg
        class="w-6 h-6 text-gray-600 group-hover:text-gray-800 transition-colors"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
      </svg>
    </div>
  </div>
</section>

<style>
  .gradient-text {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .glass-effect {
    background: rgba(255, 255, 255, 0.25);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }

  @keyframes float {
    0%,
    100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-20px);
    }
  }

  @keyframes fade-up {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-float {
    animation: float 6s ease-in-out infinite;
  }

  .animate-fade-up {
    animation: fade-up 0.6s ease-out both;
  }

  /* Intersection Observer setup */
  @media (prefers-reduced-motion: no-preference) {
    .animate-fade-up {
      opacity: 0;
    }
  }

  /* Advanced scroll-based animations */
  #hero-avatar {
    view-transition-name: avatar-transition;
  }

  #hero-title {
    view-transition-name: title-transition;
  }

  /* Smooth morphing animations */
  @keyframes morph-to-nav {
    from {
      transform: scale(1) translateY(0);
      opacity: 1;
    }
    to {
      transform: scale(0.3) translateY(-200px);
      opacity: 0.8;
    }
  }

  .hero-element-transitioning {
    animation: morph-to-nav 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  }

  /* Enhanced floating animation with better easing */
  @keyframes float-enhanced {
    0%,
    100% {
      transform: translateY(0px) rotate(0deg);
    }
    25% {
      transform: translateY(-8px) rotate(1deg);
    }
    50% {
      transform: translateY(-15px) rotate(0deg);
    }
    75% {
      transform: translateY(-8px) rotate(-1deg);
    }
  }

  .animate-float {
    animation: float-enhanced 8s ease-in-out infinite;
  }

  /* Nuevas animaciones para elementos de fondo */
  @keyframes float-slow {
    0%,
    100% {
      transform: translateY(0px) translateX(0px);
    }
    25% {
      transform: translateY(-20px) translateX(10px);
    }
    50% {
      transform: translateY(-15px) translateX(-5px);
    }
    75% {
      transform: translateY(-25px) translateX(5px);
    }
  }

  @keyframes float-slower {
    0%,
    100% {
      transform: translateY(0px) translateX(0px) scale(1);
    }
    33% {
      transform: translateY(-30px) translateX(-15px) scale(1.1);
    }
    66% {
      transform: translateY(-10px) translateX(20px) scale(0.9);
    }
  }

  @keyframes float-reverse {
    0%,
    100% {
      transform: translateY(0px) translateX(0px);
    }
    50% {
      transform: translateY(20px) translateX(-10px);
    }
  }

  .animate-float-slow {
    animation: float-slow 12s ease-in-out infinite;
  }

  .animate-float-slower {
    animation: float-slower 15s ease-in-out infinite;
  }

  .animate-float-reverse {
    animation: float-reverse 10s ease-in-out infinite reverse;
  }

  /* Grid pattern sutil */
  .bg-grid-pattern {
    background-image: linear-gradient(
        rgba(99, 102, 241, 0.15) 1px,
        transparent 1px
      ),
      linear-gradient(90deg, rgba(99, 102, 241, 0.15) 1px, transparent 1px);
    background-size: 50px 50px;
  }

  /* Mejoras responsive para los orbs */
  @media (max-width: 768px) {
    .animate-float-slow,
    .animate-float-slower,
    .animate-float-reverse {
      animation-duration: 8s;
    }
  }
</style>

<script is:inline>
  // Añadir la clase 'animated' después del primer renderizado para evitar animación en el LCP
  window.addEventListener("DOMContentLoaded", () => {
    document.getElementById("hero-avatar")?.classList.add("animated");
  });
</script>
